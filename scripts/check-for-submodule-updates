#!/bin/bash

################################################################################
# Check for submodule updates
################################################################################
#
# æ¦‚è¦
# - submodule ã«æ›´æ–°ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
#
# exit code: 0 : æ›´æ–°ã¯ãªã„ ( æœ€æ–°çŠ¶æ…‹ã§ã‚ã‚‹ )
# exit code: 1 : æ›´æ–°ãŒã‚ã‚‹
#

GIT_SUBMODULE="akiyadego-openapi"
readonly GIT_SUBMODULE

function exist_diff_from_the_latest() {
  git submodule update --init --recursive --remote "${GIT_SUBMODULE}"
  git status --short ${GIT_SUBMODULE} | wc -l | grep -q 0
}

if exist_diff_from_the_latest; then
  echo "ðŸ‘ Nothing submodule updates: ${GIT_SUBMODULE} submodule is latest."
  exit 0
else
  echo "ðŸ§ Found submodule updates: ${GIT_SUBMODULE} submodule is up to date." >&2
  exit 1
fi
